(this["webpackJsonpreact-firebase-notifications"]=this["webpackJsonpreact-firebase-notifications"]||[]).push([[0],{57:function(e,a,t){e.exports=t(92)},62:function(e,a,t){},82:function(e,a,t){},92:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(17),s=t.n(c),o=(t(62),t(18)),i=t.n(o),l=t(25),u=t(24),m=t(19),f=t.n(m),p=t(53),b=t(54),g=t(37),d=t(30),h=t(15),E=(t(81),t(82),t(56)),v=t(55),k=t(39),w=t(16),S=t(38),y=t(36),x=t(35),j=t.n(x);t(93);j.a.initializeApp({apiKey:"AIzaSyAElLIaEfWyeAEXGg0cfn9cVJ1unQsAi0I",authDomain:"web-chat-72b52.firebaseapp.com",databaseURL:"https://web-chat-72b52.firebaseio.com",projectId:"web-chat-72b52",storageBucket:"web-chat-72b52.appspot.com",messagingSenderId:"442573275776",appId:"1:442573275776:web:9f6cefe95e1e61b96fdc65",measurementId:"G-3FDDZHC2DS"});var I=j.a.messaging(),O=function(){var e=Object(l.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/registerToken",{token:a});case 2:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),C=function(e){var a=e.token,t=r.a.useState([]),n=Object(u.a)(t,2),c=n[0],s=n[1],o=r.a.useState(!1),i=Object(u.a)(o,2),l=i[0],m=i[1];return r.a.useEffect((function(){m(!0),f.a.get("/messages").then((function(e){s(e.data.messages),m(!1)}))}),[]),new Promise((function(e){I.onMessage((function(a){e(a)}))})).then((function(e){var a=e.data,t=a.title,n=a.body;h.b.info("".concat(t,"; ").concat(n))})).catch((function(e){h.b.error(JSON.stringify(e))})),r.a.createElement(d.a,null,r.a.createElement(v.a,{initialValues:{name:"",message:""},onSubmit:function(e,t){f.a.post("/messages",Object(E.a)({},e,{token:a})).then((function(e){s(e.data.messages.concat(c)),t.setSubmitting(!1),h.b.success("Submitted succesfully")})).catch((function(e){console.log(e),h.b.error("There was an error saving the message")}))}},(function(e){var a=e.handleSubmit,t=e.handleChange,n=e.isSubmitting;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{className:"mb-3"},r.a.createElement(w.a.Prepend,null,r.a.createElement(w.a.Text,{id:"basic-addon1"},"Name")),r.a.createElement(S.a,{placeholder:"Enter your name",onChange:t("name")})),r.a.createElement(w.a,{className:"mb-3"},r.a.createElement(w.a.Prepend,null,r.a.createElement(w.a.Text,{id:"basic-addon1"},"Message")),r.a.createElement(S.a,{onChange:t("message"),placeholder:"Enter a message"})),n?r.a.createElement(k.a,{variant:"primary",disabled:!0},r.a.createElement(y.a,{as:"span",size:"sm",role:"status",animation:"grow","aria-hidden":"true"}),"Loading..."):r.a.createElement(k.a,{variant:"primary",onClick:function(){return a()}},"Submit"))})),r.a.createElement("div",{className:"message-list"},r.a.createElement("h3",null,"Messages"),l?r.a.createElement(y.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):r.a.createElement(r.a.Fragment,null,c.map((function(e,a){var t=e.name,n=e.message;return r.a.createElement("div",{key:a},t,": ",n)})))))};f.a.defaults.baseURL="https://chat-mb.herokuapp.com/v1";var N=function(){var e=r.a.useState(""),a=Object(u.a)(e,2),t=a[0],c=a[1];return r.a.useEffect(Object(l.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,a){I.requestPermission().then((function(){return I.getToken()})).then((function(a){e(a)})).catch((function(e){a(e)}))}));case 3:return a=e.sent,c(a),console.log(a),e.next=8,O(a);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[]),r.a.createElement(n.Fragment,null,r.a.createElement(h.a,{autoClose:2e3,position:"top-center"}),r.a.createElement(g.a,{bg:"primary",variant:"dark"},r.a.createElement(g.a.Brand,{href:"#home"},"Firebase notifictations with React and Express")),r.a.createElement(d.a,{className:"center-column"},r.a.createElement(p.a,null,r.a.createElement(b.a,null,r.a.createElement(C,{token:t})))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.register("firebase-messaging-sw.js").then((function(e){return console.log("[SW]: SCOPE: ",e.scope),e.scope})).catch((function(e){return e}))}},[[57,1,2]]]);
//# sourceMappingURL=main.6dbc8f9b.chunk.js.map